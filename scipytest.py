import scipy
import numpy as np
import matplotlib.pyplot as plt
import pandas as pd
positionsRaw = [-0.5487394332885742, -0.551272451877594, -0.5485531091690063, -0.5469045042991638, -0.5438013672828674, -0.5408467054367065, -0.5461053848266602, -0.5540384650230408, -0.560892641544342, -0.5617185831069946, -0.5685305595397949, -0.5544537305831909, -0.544386625289917, -0.5460014343261719, -0.5457205772399902, -0.5446359515190125, -0.5474948883056641, -0.547038197517395, -0.5487011671066284, -0.5480007529258728, -0.5483039617538452, -0.5655682682991028, -0.561941385269165, -0.519269585609436, -0.48586776852607727, -0.4630546569824219, -0.49349352717399597, -0.5526813268661499, -0.5580553412437439, -0.5512169599533081, -0.5196753740310669, -0.4681299924850464, -0.4550231099128723, -0.49551281332969666, -0.5376167893409729, -0.5545663833618164, -0.5422412157058716, -0.5098467469215393, -0.4634692668914795, -0.4670588970184326, -0.5025277137756348, -0.549534797668457, -0.5514734387397766, -0.5274946093559265, -0.5175681114196777, -0.501381516456604, -0.4777752459049225, -0.4807640016078949, -0.48731714487075806, -0.49330589175224304, -0.5189809203147888, -0.5023021101951599, -0.5013737082481384, -0.5260518193244934, -0.528044581413269, -0.5344967246055603, -0.5335687398910522, -0.5243558287620544, -0.5068579912185669, -0.4828381836414337, -0.46455875039100647, -0.41817426681518555, -0.40977638959884644, -0.43315115571022034, -0.47480037808418274, -0.5163146257400513, -0.5249580144882202, -0.47337764501571655, -0.4686970114707947, -0.47339391708374023, -0.5032780170440674, -0.5291159152984619, -0.5434567928314209, -0.5114110112190247, -0.48636797070503235, -0.4426412284374237, -0.4271262288093567, -0.4379154145717621, -0.468642920255661, -0.49529507756233215, -0.4919275939464569, -0.4759616553783417, -0.4484555125236511, -0.44991421699523926, -0.4678701162338257, -0.49030983448028564, -0.47549208998680115, -0.4322918653488159, -0.4140715003013611, -0.40897971391677856, -0.43710169196128845, -0.49411553144454956, -0.5416169762611389, -0.5213209986686707, -0.5086147785186768, -0.5023306012153625, -0.5028992891311646, -0.5042487978935242, -0.5187981724739075, -0.5140178799629211, -0.4986776113510132, -0.4712551534175873, -0.4478950500488281, -0.4062460958957672, -0.379940003156662, -0.3755374550819397, -0.39299333095550537, -0.46514299511909485, -0.5081208944320679, -0.4933469891548157, -0.5081568360328674, -0.508060097694397, -0.4752354025840759, -0.4606110751628876, -0.49416378140449524, -0.5206453800201416, -0.5523602962493896, -0.5456247329711914, -0.5499073266983032, -0.5426644086837769, -0.5446252822875977, -0.5232217311859131, -0.4709412157535553, -0.34116998314857483, -0.38255026936531067, -0.3457229733467102, -0.3248284161090851, -0.27642831206321716, -0.31425148248672485, -0.3843267560005188, -0.4391776919364929, -0.43948355317115784, -0.4123314321041107, -0.39207199215888977, -0.3885759115219116, -0.4316484332084656, -0.44558778405189514, -0.447587251663208, -0.4354950785636902, -0.4179454445838928, -0.41480517387390137, -0.4278465211391449, -0.45969510078430176, -0.4010094404220581, -0.38538721203804016, -0.4100111126899719, -0.41813501715660095, -0.43741655349731445, -0.42784708738327026, -0.41408205032348633, -0.41444939374923706, -0.4090387523174286, -0.4209551513195038, -0.39368465542793274, -0.41320809721946716, -0.4275675117969513, -0.4290328919887543, -0.42157724499702454, -0.3845124840736389, -0.39590737223625183, -0.4108484387397766, -0.41293564438819885, -0.3937076926231384, -0.34041357040405273, -0.3528516888618469, -0.3921129107475281, -0.42161136865615845, -0.3809605538845062, -0.36670032143592834, -0.4089834988117218, -0.41699278354644775, -0.39901062846183777, -0.361025333404541, -0.36287739872932434, -0.3892717659473419, -0.41145211458206177, -0.4088461697101593, -0.3909611999988556, -0.37922796607017517, -0.3944973349571228, -0.4104255735874176, -0.4237440228462219, -0.37856805324554443, -0.40810704231262207, -0.4470381736755371, -0.44636964797973633, -0.45159319043159485, -0.4196004569530487, -0.4215318560600281, -0.4269081950187683, -0.4409027099609375, -0.4477931559085846, -0.453867644071579, -0.45397740602493286, -0.45971420407295227, -0.4544146955013275, -0.44748765230178833, -0.43531960248947144, -0.4343278706073761, -0.43871790170669556, -0.4442615211009979, -0.45986780524253845, -0.4590063691139221, -0.44749343395233154, -0.41936078667640686, -0.3738670349121094, -0.3663187623023987, -0.3719913363456726, -0.3760806620121002, -0.382635235786438, -0.38218358159065247, -0.3834007680416107, -0.38318294286727905, -0.37564146518707275, -0.37397608160972595, -0.3711356818675995, -0.3736704885959625, -0.3784809112548828, -0.38152727484703064, -0.3835521340370178, -0.3823210895061493, -0.3641308546066284, -0.3448391258716583, -0.3533954918384552, -0.35093680024147034, -0.42901256680488586, -0.48657676577568054, -0.5306761264801025, -0.5773266553878784, -0.6191091537475586, -0.6008517742156982, -0.6300517320632935, -0.5628994107246399, -0.4896622896194458, -0.4885466694831848, -0.5365499258041382, -0.5460011959075928, -0.5474432706832886, -0.5519368052482605, -0.5514881610870361, -0.5509993433952332, -0.5461342334747314, -0.5386590957641602, -0.5341848134994507, -0.5479288101196289, -0.5609232783317566, -0.5593199133872986, -0.48329412937164307, -0.5296906232833862, -0.5568886399269104, -0.5505767464637756, -0.5405874252319336, -0.5456047654151917, -0.48077064752578735, -0.4153020977973938, -0.38360586762428284, -0.3668622374534607, -0.37837451696395874, -0.38439619541168213, -0.39409658312797546, -0.39193302392959595, -0.3900332450866699, -0.4051004946231842, -0.39154917001724243, -0.384543776512146, -0.3813742697238922, -0.3629026710987091, -0.3631792664527893, -0.3627045154571533, -0.36847448348999023, -0.3816691040992737, -0.40907689929008484, -0.4274386465549469, -0.3409308195114136, -0.36055806279182434, -0.3882916271686554, -0.42332345247268677, -0.4222009778022766, -0.41041886806488037, -0.4614317715167999, -0.5449060797691345, -0.548000693321228, -0.5521063804626465, -0.5133293271064758, -0.41545745730400085, -0.41313740611076355, -0.417671799659729, -0.527824342250824, -0.5220776200294495, -0.548970103263855, -0.5283615589141846, -0.43734297156333923, -0.507765531539917, -0.4675189256668091, -0.41457730531692505, -0.41223737597465515, -0.4107356071472168, -0.39769446849823, -0.3995053470134735, -0.41091689467430115, -0.43859413266181946, -0.5271733403205872, -0.42961448431015015, -0.41601231694221497, -0.4056629538536072, -0.3940168023109436, -0.3917306661605835, -0.3936788737773895, -0.40701621770858765, -0.43533697724342346, -0.46474534273147583, -0.49983546137809753, -0.5072696805000305, -0.5425983667373657, -0.5330725908279419, -0.5514757633209229, -0.545914888381958, -0.5531932711601257, -0.5509406924247742, -0.5479393601417542, -0.5493809580802917, -0.5468050837516785, -0.5411609411239624, -0.5364084839820862, -0.5105167627334595, -0.5207887291908264, -0.5222007036209106, -0.5089951753616333, -0.5042701363563538, -0.5140650272369385, -0.5098484754562378, -0.5109740495681763, -0.5090089440345764, -0.5154677629470825, -0.5343539714813232, -0.5435702204704285, -0.545129656791687, -0.5483770370483398, -0.5513980388641357, -0.5381538271903992, -0.5478014349937439, -0.5526320338249207, -0.5541326999664307, -0.5513887405395508, -0.5501648187637329, -0.5519856810569763, -0.5571565628051758, -0.5552038550376892, -0.5578210353851318, -0.5562381148338318, -0.5558322668075562, -0.5547439455986023, -0.5561609268188477, -0.5549687147140503, -0.5567787289619446, -0.5583439469337463, -0.5586705803871155, -0.5590381026268005, -0.5593752861022949, -0.558347761631012, -0.5581611394882202, -0.5585684180259705, -0.5597307682037354, -0.5595389604568481, -0.5584288835525513, -0.5569887757301331, -0.5574495792388916, -0.5575111508369446, -0.5556719303131104, -0.5541052222251892, -0.5454510450363159, -0.5443981885910034, -0.5797713994979858, -0.5945987701416016, -0.5134645104408264, -0.46977004408836365, -0.5010091066360474, -0.4265247881412506, -0.4983062446117401, -0.49210360646247864, -0.5144249796867371, -0.485609769821167, -0.44744980335235596, -0.4352209270000458, -0.47973090410232544, -0.5532976984977722, -0.4118576943874359, -0.4544733762741089, -0.4212563931941986, -0.5277023315429688, -0.5013300776481628, -0.5153955817222595, -0.4640144407749176, -0.44851794838905334, -0.5078852772712708, -0.5615009665489197, -0.5639345645904541, -0.5046785473823547, -0.4443100392818451, -0.47309231758117676, -0.4124690592288971, -0.3807967007160187, -0.4080145061016083, -0.44724899530410767, -0.4372902810573578, -0.4450623393058777, -0.4093918204307556, -0.41965585947036743, -0.46637454628944397, -0.4900590777397156, -0.496725857257843, -0.4807531535625458, -0.46523216366767883, -0.43934640288352966, -0.41529566049575806, -0.3664354979991913, -0.46916791796684265, -0.4699084758758545, -0.41127142310142517, -0.3904871642589569, -0.37223386764526367, -0.4019685983657837, -0.5276435613632202, -0.47891077399253845, -0.484045147895813, -0.5007140636444092, -0.46705880761146545, -0.44414860010147095, -0.46840617060661316, -0.512053370475769, -0.5216473340988159, -0.4884240925312042, -0.49460238218307495, -0.5738947987556458, -0.5666117072105408, -0.5207878947257996, -0.4954628348350525, -0.5164222121238708, -0.5092795491218567, -0.546819269657135, -0.5665940642356873, -0.5577406287193298, -0.533348023891449, -0.5126057863235474, -0.49222633242607117, -0.48531147837638855, -0.5045408606529236, -0.5293527245521545, -0.5170130729675293, -0.43528226017951965, -0.39060288667678833, -0.43008190393447876, -0.4618578553199768, -0.41727414727211, -0.399016797542572, -0.45926907658576965, -0.4640372097492218, -0.4848676025867462, -0.4947924017906189, -0.4890952706336975, -0.4843079745769501, -0.46414196491241455, -0.46324557065963745, -0.5128669142723083, -0.5382760763168335, -0.5297635793685913, -0.49035313725471497, -0.44683799147605896, -0.4335266649723053, -0.46788322925567627, -0.4221419394016266, -0.427643746137619, -0.47483742237091064, -0.46276935935020447, -0.4644162356853485, -0.4700849652290344, -0.4920719563961029, -0.5170403122901917, -0.4932350218296051, -0.47664719820022583, -0.4770529568195343, -0.4410801827907562, -0.4581952691078186, -0.5432571768760681, -0.5454131960868835, -0.5335361957550049, -0.5397762060165405, -0.5609182715415955, -0.5445346236228943, -0.551056981086731, -0.4858088493347168, -0.4483513832092285, -0.41015785932540894, -0.3881802558898926, -0.38860252499580383, -0.39685487747192383, -0.41368094086647034, -0.4271569848060608, -0.4095069169998169, -0.40433239936828613, -0.3760714530944824, -0.36154288053512573, -0.36737915873527527, -0.3334193229675293, -0.372121125459671, -0.32990697026252747, -0.31142982840538025, -0.4009009897708893, -0.3915369212627411, -0.3864135444164276, -0.3706666827201843, -0.447483092546463, -0.4980258047580719, -0.4968075156211853, -0.4966888427734375, -0.43525010347366333, -0.3861179053783417, -0.3811657428741455, -0.39931920170783997, -0.46035236120224, -0.46824246644973755, -0.459091454744339, -0.4493879973888397, -0.4438856840133667, -0.4859669506549835, -0.5197075009346008, -0.5415183901786804, -0.551260232925415, -0.5467007756233215, -0.5407345294952393, -0.5444576740264893, -0.5393863916397095, -0.5352650284767151, -0.5598068833351135, -0.5574596524238586, -0.5584790706634521, -0.5537243485450745, -0.5479786992073059, -0.5483846664428711, -0.5524518489837646, -0.5496876835823059, -0.5424744486808777, -0.5184014439582825, -0.5052958726882935, -0.5003812313079834, -0.5261163115501404, -0.5289448499679565, -0.5265392065048218, -0.5276119709014893, -0.5245649218559265, -0.5087194442749023, -0.5094784498214722, -0.5174767971038818, -0.5137218236923218, -0.5134097337722778, -0.5068992376327515, -0.5244821906089783, -0.5241571664810181, -0.5331854224205017, -0.5331600904464722, -0.5304703712463379, -0.5195926427841187, -0.5198420882225037, -0.5333264470100403, -0.5270677208900452, -0.5195759534835815, -0.5341470837593079, -0.5352880954742432, -0.536198616027832, -0.5352966785430908, -0.525321364402771, -0.5148929357528687, -0.5254284143447876, -0.530275821685791, -0.5307084321975708, -0.5296129584312439, -0.520378053188324, -0.5117866396903992, -0.5111666321754456, -0.513326108455658, -0.5110419988632202, -0.5106080174446106, -0.5067650079727173, -0.5048950910568237, -0.5091053247451782, -0.512813925743103, -0.5123468041419983, -0.5109170079231262, -0.5047826170921326, -0.5010270476341248, -0.49583134055137634, -0.4998047649860382, -0.5115813612937927, -0.5050667524337769, -0.5122907161712646, -0.5036472082138062, -0.4983643889427185, -0.495439350605011, -0.49532628059387207, -0.4970329701900482, -0.4929341673851013, -0.5003699064254761, -0.5027457475662231, -0.5055393576622009, -0.5086860060691833, -0.5084056258201599, -0.5073435306549072, -0.511403501033783, -0.5306003093719482, -0.5535923838615417, -0.5550753474235535, -0.5465888381004333, -0.5471943616867065, -0.5444731116294861, -0.5443955063819885, -0.5497828125953674, -0.546886682510376, -0.5501185655593872, -0.5529367923736572, -0.5514883399009705, -0.5470869541168213, -0.5487236976623535, -0.5499637126922607, -0.5479594469070435, -0.5465690493583679, -0.5500636100769043, -0.5449069738388062, -0.5443921089172363, -0.5467098951339722, -0.541750967502594, -0.5429956912994385, -0.542938768863678, -0.546234667301178, -0.5448076128959656, -0.5472591519355774, -0.5537546277046204, -0.5485857725143433, -0.5512709021568298, -0.5534761548042297, -0.5538666844367981, -0.5512006878852844, -0.549943208694458, -0.5530329346656799, -0.5549403429031372, -0.5587519407272339, -0.55787593126297, -0.5508368015289307, -0.5471274256706238, -0.5544318556785583, -0.5388199687004089, -0.5428956151008606, -0.5419802069664001, -0.5413770079612732, -0.5384809970855713, -0.5472620129585266, -0.5481767654418945, -0.5486364364624023, -0.5469539165496826, -0.5493339896202087, -0.5521786212921143, -0.5561537146568298, -0.5516700744628906, -0.5489217042922974, -0.5501976609230042, -0.5484919548034668, -0.5458434820175171, -0.5439719557762146, -0.5448443293571472, -0.5462417006492615, -0.5464069247245789, -0.5464651584625244, -0.5442913174629211, -0.5490963459014893, -0.5495206117630005, -0.5434628129005432, -0.5231896042823792, -0.517228364944458, -0.5239993333816528, -0.5350512266159058, -0.5434249639511108, -0.5620511174201965, -0.5547626614570618, -0.5555219650268555, -0.5475749969482422, -0.5508832931518555]#[-0.5325853824615479, -0.5281127691268921, -0.5290588736534119, -0.5304548144340515, -0.5333521366119385, -0.5307444930076599, -0.5278468728065491, -0.5253414511680603, -0.5260096192359924, -0.5239031910896301, -0.5205500721931458, -0.5306524634361267, -0.5255883932113647, -0.524369478225708, -0.5246816873550415, -0.5251373648643494, -0.5070542097091675, -0.1596561074256897, -0.2748352587223053, -0.5370266437530518, -0.5285013914108276, -0.5342650413513184, -0.49714159965515137, -0.2835574746131897, -0.5381671786308289, -0.5254161357879639, -0.518320620059967, -0.4009876549243927, -0.2913513481616974, -0.27032309770584106, -0.26383814215660095, -0.2635855972766876, -0.2839866280555725, -0.2706622779369354, -0.26878300309181213, -0.2752262353897095, -0.27787482738494873, -0.2728360891342163, -0.29231274127960205, -0.5037683248519897, -0.487113356590271, -0.5147505402565002, -0.5232182741165161, -0.5123218297958374, -0.5065184831619263, -0.502612829208374, -0.5622235536575317, -0.535287618637085, -0.5270190238952637, -0.5210617184638977, -0.5200075507164001, -0.541414201259613, -0.5318821668624878, -0.5302230715751648, -0.5434635281562805, -0.5190985202789307, -0.5285911560058594, -0.27763038873672485, -0.2040533721446991, -0.2954142689704895, -0.1844327300786972, -0.17900443077087402, -0.16740913689136505, -0.2021346390247345, -0.25773367285728455, -0.29369816184043884, -0.31485310196876526, -0.34699833393096924, -0.3636628985404968, -0.3990092873573303, -0.4397791624069214, -0.4539563059806824, -0.49906352162361145, -0.4753902852535248, -0.5068198442459106, -0.5249791145324707, -0.5217489004135132, -0.5153177976608276, -0.5169880390167236, -0.5179898142814636, -0.5215202569961548, -0.5156538486480713, -0.5198249220848083, -0.515617847442627, -0.5224604606628418, -0.5288903713226318, -0.521913468837738, -0.5141330361366272, -0.5209856033325195, -0.5262646675109863, -0.5248959064483643, -0.5159061551094055, -0.5285964012145996, -0.5232099890708923, -0.5195029377937317, -0.5208622217178345, -0.5146800875663757, -0.5166069269180298, -0.5134304761886597, -0.5117613673210144, -0.5054910778999329, -0.5076296925544739]

from scipy.signal import find_peaks

#time = np.arange(len(positionsRaw))

# Calculate the change in position and change in time
#delta_position = np.diff(positionsRaw)
#delta_time = np.diff(time)

# Calculate velocity
#velocityRaw = delta_position / delta_time
#pandasVelocity = pd.Series(velocityRaw)

#velocity_moving_average = pandasVelocity.rolling(window=10).mean()
#velocity_moving_average = velocity_moving_average.tolist()

#velocity_moving_average=pandasVelocity.tolist()
x = np.arange(len(positionsRaw))
y = np.array(positionsRaw)

#To maximize:
max_indexes = find_peaks(y,threshold=0.01)[0]#,threshold=5,distance=1)[0]
x_points_max = x[max_indexes]
y_points_max = y[max_indexes]

print(x_points_max)

#To minimize:
min_indexes = find_peaks(-y,threshold=0.01)[0]#,threshold=5,distance=1)[0]
x_points_min = x[min_indexes]
y_points_min = y[min_indexes]

#Plot our data
plt.plot(x,y)
plt.xlabel('Temperature (degC)')
plt.ylabel('Solubility of O2 (mg/L)')

plt.plot(x_points_max, y_points_max, 'g*')

plt.plot(x_points_min, y_points_min, 'ro')

plt.show()